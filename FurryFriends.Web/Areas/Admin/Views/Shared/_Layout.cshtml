<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"] - Furry Friends Admin</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="~/css/admin-loading.css" />
    <link rel="stylesheet" href="~/css/admin.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    @RenderSection("Styles", required: false)
</head>
<body>
    @inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
    @{
        var hoTen = HttpContextAccessor.HttpContext?.Session.GetString("HoTen") ?? "Chưa đăng nhập";
        var role = HttpContextAccessor.HttpContext?.Session.GetString("Role") ?? "";
    }
    <header class="admin-header d-flex justify-content-end align-items-center px-4 py-2 shadow-sm" style="background: #fff; min-height: 60px; border-bottom: 1px solid #e5e7eb; position: sticky; top: 0; z-index: 1000;">
        <div class="d-flex align-items-center gap-3 ms-auto">
            <div class="position-relative">
                <i class="fas fa-bell fa-lg text-secondary" style="cursor:pointer;"></i>
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size:10px;"> </span>
            </div>
            <div class="d-flex align-items-center gap-2">
                <div class="d-flex flex-column align-items-end me-2">
                    <span class="fw-semibold text-dark">@hoTen</span>
                    <span class="text-muted small" style="font-size:12px;">@role</span>
                </div>
                <img src="/images/default-avatar.png" alt="avatar" class="rounded-circle" style="width:36px; height:36px; object-fit:cover; border:2px solid #e5e7eb;" />
            </div>
        </div>
    </header>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="admin-sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="@Url.Action("Index", "Dashboard", new { area = "Admin" })" class="sidebar-brand">
                    <div class="">
                        <img src="/images/hihihi.png" alt="Logo" style="height: 40px;" />
                    </div>

                    <h1 class="brand-text">Furry Friends</h1>
                </a>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <h3 class="nav-section-title">Dashboard</h3>
                    <ul class="nav-item">
                        <li>
                            <a href="@Url.Action("Index", "Dashboard", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Home" ? "active" : "")">
                                <i class="nav-icon fas fa-tachometer-alt"></i>
                                <span>Tổng quan</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3 class="nav-section-title">Quản lý</h3>
                    <ul class="nav-item">
                        <li>
                            <a href="@Url.Action("Index", "KhachHangs", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "KhachHangs" ? "active" : "")">
                                <i class="nav-icon fas fa-users"></i>
                                <span>Khách hàng</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "NhanVien", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "NhanVien" ? "active" : "")">
                                <i class="nav-icon fas fa-user-tie"></i>
                                <span>Nhân viên</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "ChucVu", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "ChucVu" ? "active" : "")">
                                <i class="nav-icon fas fa-id-badge"></i>
                                <span>Chức vụ</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "Vouchers", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Vouchers" ? "active" : "")">
                                <i class="nav-icon fas fa-ticket-alt"></i>
                                <span>Voucher</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3 class="nav-section-title">Sản phẩm</h3>
                    <ul class="nav-item">
                        <li>
                            <a href="@Url.Action("Index", "SanPham", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "SanPham" ? "active" : "")">
                                <i class="nav-icon fas fa-box"></i>
                                <span>Sản phẩm</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "Anh", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "Anh" ? "active" : "")">
                                <i class="nav-icon fas fa-image"></i>
                                <span>Quản lý ảnh</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "BanHang", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "BanHang" ? "active" : "")">
                                <i class="nav-icon fas fa-image"></i>
                                <span>BanHang</span>
                            </a>
                        </li>
@*                         <li>
                            <a href="@Url.Action("Index", "DanhMuc", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "DanhMuc" ? "active" : "")">
                                <i class="nav-icon fas fa-tags"></i>
                                <span>Danh mục</span>
                            </a>
                        </li> *@
                        <li>
                            <a href="@Url.Action("Index", "ChatLieu", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "ChatLieu" ? "active" : "")">
                                <i class="nav-icon fas fa-cube"></i>
                                <span>Chất liệu</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "ThuongHieu", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "ThuongHieu" ? "active" : "")">
                                <i class="nav-icon fas fa-copyright"></i>
                                <span>Thương hiệu</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "MauSac", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "MauSac" ? "active" : "")">
                                <i class="nav-icon fas fa-palette"></i>
                                <span>Màu sắc</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "KichCo", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "KichCo" ? "active" : "")">
                                <i class="nav-icon fas fa-ruler-combined"></i>
                                <span>Kích cỡ</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "ThanhPhan", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "ThanhPhan" ? "active" : "")">
                                <i class="nav-icon fas fa-layer-group"></i>
                                <span>Thành phần</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3 class="nav-section-title">Đơn hàng</h3>
                    <ul class="nav-item">
                        <li>
                            <a href="@Url.Action("Index", "HoaDon", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "HoaDon" ? "active" : "")">
                                <i class="nav-icon fas fa-shopping-cart"></i>
                                <span>Hóa đơn</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "GiamGia", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "GiamGias" ? "active" : "")">
                                <i class="nav-icon fas fa-percent"></i>
                                <span>Giảm giá</span>
                            </a>
                        </li>
                        <li>
                            <a href="@Url.Action("Index", "DotGiamGias", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "DotGiamGias" ? "active" : "")">
                                <i class="nav-icon fas fa-calendar-alt"></i>
                                <span>Đợt giảm giá</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3 class="nav-section-title">Hệ thống</h3>
                    <ul class="nav-item">
                        <li>
                            <a href="@Url.Action("Index", "TaiKhoan", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "TaiKhoan" ? "active" : "")">
                                <i class="nav-icon fas fa-user-shield"></i>
                                <span>Tài khoản</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3 class="nav-section-title">Thông báo</h3>
                    <ul class="nav-item">
                        <li>
                            <a href="@Url.Action("Index", "ThongBao", new { area = "Admin" })" class="nav-link @(ViewContext.RouteData.Values["Controller"]?.ToString() == "ThongBao" ? "active" : "")">
                                <i class="nav-icon bi bi-bell"></i>
                                <span>Thông báo</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="top-bar">
                <button class="sidebar-toggle" onclick="toggleSidebarAndOverlay()">
        <i class="fas fa-bars"></i>
    </button>
                @RenderSection("TopBar", required: false)
            </div>
            @RenderBody()
        </main>
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebarAndOverlay()"></div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-container">
            <div class="loader">
                <div class="dog">
                    <div class="dog-body">
                        <div class="dog-tail">
                            <div class="dog-tail">
                                <div class="dog-tail">
                                    <div class="dog-tail">
                                        <div class="dog-tail">
                                            <div class="dog-tail">
                                                <div class="dog-tail">
                                                    <div class="dog-tail"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="dog-torso"></div>
                    <div class="dog-head">
                        <div class="dog-ears">
                            <div class="dog-ear"></div>
                            <div class="dog-ear"></div>
                        </div>
                        <div class="dog-eyes">
                            <div class="dog-eye"></div>
                            <div class="dog-eye"></div>
                        </div>
                        <div class="dog-muzzle">
                            <div class="dog-tongue"></div>
                        </div>
                    </div>
                </div>
            </div>
            <p class="loading-text" id="loadingText">Đang tải trang...</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="~/js/admin-loading.js"></script>
    <script src="~/js/siteadmin.js"></script>
    <script src="~/js/notification.js"></script>

    <script>
        // Sidebar toggle for mobile
        function toggleSidebarAndOverlay() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.toggle('show');
            if (sidebar.classList.contains('show')) {
                overlay.style.display = 'block';
            } else {
                overlay.style.display = 'none';
            }
        }
        function closeSidebarAndOverlay() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            sidebar.classList.remove('show');
            overlay.style.display = 'none';
        }
        // Close sidebar when clicking outside on mobile (for accessibility)
        document.addEventListener('click', function(e) {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth <= 1024 && sidebar.classList.contains('show')) {
                if (!sidebar.contains(e.target) && !e.target.closest('.sidebar-toggle')) {
                    sidebar.classList.remove('show');
                    overlay.style.display = 'none';
                }
            }
        });
        // Responsive sidebar behavior
        window.addEventListener('resize', function() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            if (window.innerWidth > 1024) {
                sidebar.classList.remove('show');
                overlay.style.display = 'none';
            }
        });
        // Initialize admin loading
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof window.adminLoading !== 'undefined') {
                window.adminLoading.init();
            }
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
