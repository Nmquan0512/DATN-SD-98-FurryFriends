@model FurryFriends.API.Models.DTO.GiamGiaDTO
@{
    ViewData["Title"] = "Chi tiết chương trình giảm giá";
    var sanPhamChiTietList = ViewBag.SanPhamChiTietList as IEnumerable<dynamic>;
}
<div class="container-fluid px-4">
    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb bg-white rounded shadow-sm px-3 py-2">
            <li class="breadcrumb-item"><a asp-area="Admin" asp-controller="Dashboard" asp-action="Index">Trang chủ</a></li>
            <li class="breadcrumb-item"><a asp-area="Admin" asp-action="Index" asp-controller="GiamGia">Quản lý giảm giá</a></li>
            <li class="breadcrumb-item active">Chi tiết</li>
        </ol>
    </nav>
    <div class="row mb-4">
        <div class="col-lg-7">
            <div class="card border-0 shadow-sm rounded-4 mb-3">
                <div class="card-body">
                    <h3 class="fw-bold text-primary mb-3"><i class="fas fa-tag me-2"></i>@Model.TenGiamGia</h3>
                    <div class="mb-2"><strong>Phần trăm khuyến mãi:</strong> <span class="badge bg-info text-dark">@Model.PhanTramKhuyenMai %</span></div>
                    <div class="mb-2"><strong>Ngày bắt đầu:</strong> <span class="text-primary">@Model.NgayBatDau?.ToString("dd/MM/yyyy")</span></div>
                    <div class="mb-2"><strong>Ngày kết thúc:</strong> <span class="text-danger">@Model.NgayKetThuc?.ToString("dd/MM/yyyy")</span></div>
                    <div class="mb-2"><strong>Trạng thái:</strong>
    @if (Model.TrangThai)
    {
        <span class="badge bg-success">Đang áp dụng</span>
    }
    else
    {
        <span class="badge bg-secondary">Ngừng áp dụng</span>
    }
</div>
                </div>
            </div>
        </div>
    </div>
    <div class="card border-0 shadow-sm rounded-4 mb-4">
        <div class="card-header bg-white border-0 pb-0">
            <h5 class="mb-0 text-primary"><i class="fas fa-box-open me-2"></i>Danh sách sản phẩm áp dụng</h5>
        </div>
        <div class="card-body">
            @if (sanPhamChiTietList != null && sanPhamChiTietList.Any())
            {
                <div class="table-responsive">
                    <table class="table table-bordered table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Ảnh</th>
                                <th>Tên sản phẩm</th>
                                <th>Màu</th>
                                <th>Kích cỡ</th>
                                <th>Giá</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var sp in sanPhamChiTietList)
                            {
                                <tr>
                                    <td>
                                        @if (!string.IsNullOrEmpty(sp.DuongDan))
                                        {
                                            var imgSrc = sp.DuongDan.StartsWith("http://localhost:7289") || sp.DuongDan.StartsWith("https://localhost:7289")
                                                ? sp.DuongDan
                                                : $"https://localhost:7289{(sp.DuongDan.StartsWith("/") ? sp.DuongDan : "/" + sp.DuongDan)}";
                                            <img src="@imgSrc" style="width:60px;height:60px;object-fit:cover;" />
                                        }
                                        else
                                        {
                                            <span class="text-muted">Không có</span>
                                        }
                                    </td>
                                    <td>@sp.TenSanPham</td>
                                    <td>@sp.TenMau</td>
                                    <td>@sp.TenKichCo</td>
                                    <td>@sp.Gia.ToString("N0") ₫</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                <div class="alert alert-info">Chưa có sản phẩm nào được áp dụng cho chương trình này.</div>
            }
        </div>
    </div>
    <a asp-action="Index" class="btn btn-secondary mt-3"><i class="fas fa-arrow-left me-2"></i>Quay lại</a>
</div>
